c3<-ldaline(c1)
plot(donguri1$tate, donguri1$yoko, pch=donguri1$type+16)
abline(c3,col=2)
c1<-lda(type~tate+yoko, donguri2)
c2 <- predict(c1)
print(c1)
print(c2)
c1$scaling
ldaline(c1)
c3<-ldaline(c1)
plot(donguri2$tate, donguri2$yoko, pch=donguri2$type+16)
abline(c3,col=2)
load("~/Rprojects/searchDonguri/.RData")
View(ldaline)
sleep
plot(donguri2$tate, donguri2$yoko, pch=donguri2$type+16)
abline(c3,col=2)
png("donguri2.png")
plot(donguri2$tate, donguri2$yoko, pch=donguri2$type+16)
abline(c3,col=2)
dev.off()
png("donguri1.png")
c1<-lda(type~tate+yoko, donguri1)
c2 <- predict(c1)
ldaline(c1)
library(MASS)
c1<-lda(type~tate+yoko, donguri1)
c2 <- predict(c1)
ldaline(c1)
plot(donguri1$tate, donguri1$yoko, pch=donguri1$type+16)
abline(c3,col=2)
dev.off()
View(donguri1)
install.packages("kernlab")
library(kernlab)
rowdata <- nrow(donguri2)
random_ids <- sample(rowdata, rowdata/2)
random_ids
donguri2_training <- donguri2[random_ids,]
donguri2_training
donguri2_predictiong <- donguri2[-random_ids,]
donguri2_predictiong
donguri_svm <- ksvm(type~tate+yoko, data=donguri2_training)
donguri_svm
result_predict <- predict(donguri_svm, donguri2_predictiong)
result_predict
table(result_predict, donguri2_predictiong$type)
View(donguri1)
View(donguri1)
View(donguri1)
View(donguri1A)
View(donguri1A)
plot(donguri_svm, data=donguri2)
donguri_svm <- ksvm(type~tate+yoko, data=donguri2_training)
donguri_svm <- ksvm(type~tate+yoko, data=donguri2_training)
library(kernlab)
donguri_svm <- ksvm(type~tate+yoko, data=donguri2_training)
table(result_predict, donguri2_predictiong$type)
plot(donguri_svm, data=donguri2)
set.seed(10)
y <- as.matrix(donguri2[,3])
don2 <- data.frame(donguri2[,1:2],y)
don.svm <- ksvm(y~., data=don2)
plot(ir.ksvm, data=don2[,1;2])
plot(ir.ksvm, data=don2[,1:2])
plot(don2.ksvm, data=don2[,1:2])
plot(don.ksvm, data=don2[,1:2])
plot(don.svm, data=don2[,1:2])
don.ksvm <- ksvm(y~., data=don2)
plot(don.ksvm, data=don2[,1:2])
table(don2$y, predict(don.ksvm, don2[,1:2]))
table(don2$y, predict(don.ksvm, don2[,1:2]))
donguri1_v2 <- read.csv("donguri1_v2.csv", header = TRUE)
donguri2_v2 <- read.csv("donguri2_v2.csv", header = TRUE)
View(donguri2_v2)
don.ksvm <- ksvm(type~., data=donguri2_v2)
plot(don.ksvm, data=donguri2_v2)
table(don2$y, predict(don.ksvm, donguri2_v2)
table(donguri2_v2$type, predict(don.ksvm, donguri2_v2))
rowdata <- nrow(donguri2_v2)
random_ids <- sample(rowdata, rowdata/2)
random_ids
donguri2_training <- donguri2_v2[random_ids,]
donguri2_predictiong <- donguri2_v2[-random_ids,]
donguri_svm <- ksvm(type~tate+yoko, data=donguri2_training)
donguri_svm
result_predict <- predict(donguri_svm, donguri2_predictiong)
result_predict
table(result_predict, donguri2_predictiong$type)
plot(donguri_svm, data=donguri2_training)
plot(donguri_svm, data=donguri2_v2)
table(result_predict, donguri2_predictiong$type)
set.seed(10)
y <- as.matrix(donguri2[,3])
don2 <- data.frame(donguri2[,1:2],y)
don.ksvm <- ksvm(type~., data=donguri2_v2)
plot(don.ksvm, data=donguri2_v2)
table(donguri2_v2$type, predict(don.ksvm, donguri2_v2))
png("donguri2_svm.png")
plot(don.ksvm, data=donguri2_v2)
dev.off()
don.ksvm <- ksvm(type~., data=donguri2_v2)
plot(don.ksvm, data=donguri2_v2)
table(donguri2_v2$type, predict(don.ksvm, donguri2_v2))
png("donguri2_svm.png")
dev.off()
png("donguri1_svm.png")
don.ksvm <- ksvm(type~., data=donguri1_v2)
plot(don.ksvm, data=donguri1_v2)
dev.off()
don.ksvm <- ksvm(type~., data=donguri1_v2)
plot(don.ksvm, data=donguri1_v2)
table(donguri1_v2$type, predict(don.ksvm, donguri1_v2))
library(ipred)
library(kernlab)
set.seed(50)
row <- nrow(donguri1_v2)
(row <- nrow(donguri1_v2))
x <- sample(10,3)
(x <- sample(10,3))
(rowdata <- nrow(donguri1_v2))
random_ids <- sample(rowdata, rowdata/2)
don1.train <- donguri1_v2[random_ids]
don1.train <- donguri1_v2[random_ids,]
don1.test <- donguri1_v2[-random_ids,]
don1.bag <- bagging(type~., data=don1.train, nbagg=40)
rm(y)
rm(donguri1A)
(rm(list=ls())
(rm(list=ls()))
donguri1 <- read.csv("donguri1_v2.csv", header = TRUE)
donguri2 <- read.csv("donguri2_v2.csv", header = TRUE)
(rowdata <- nrow(donguri1_v2))
random_ids <- sample(rowdata, rowdata/2)
(rowdata <- nrow(donguri1))
random_ids <- sample(rowdata, rowdata/2)
don1.train <- donguri1_v2[random_ids,]
don1.test <- donguri1_v2[-random_ids,]
don1.train <- donguri1[random_ids,]
don1.test <- donguri1[-random_ids,]
don1.bag <- bagging(type~., data=don1.train, nbagg=40)
library(ipred)
library(kernlab)
don1.bag <- bagging(type~., data=don1.train, nbagg=40)
don1.bagprd <- predict(don1.bag, don1.test[,-58], type="class")
don1.bagprd <- predict(don1.bag, don1.test[,58], type="class")
don1.bagprd <- predict(don1.bag, don1.test[,-58], type="class")
(don1.bagt <- table(don1.test[,58], don1.bagprd))
don1.bagprd <- predict(don1.bag, don1.test[,-28], type="class")
(don1.bagt <- table(don1.test[,28], don1.bagprd))
nrow(don1.test)
don1.bagprd <- predict(don1.bag, don1.test[,-3], type="class")
(don1.bagt <- table(don1.test[,3], don1.bagprd))
sum(diag(don1.bagt))/sum(don1.bagt)
don2.train <-donguri2[random_ids,]
don2.test <- donguri2[-random_ids,]
don2.bag <- bagging(type~. data=don2.train, nbagg=40)
don2.bag <- bagging(type~., data=don2.train, nbagg=40)
don2.bagprd <- predict(don2.bag, don2.test[,-3], type="class")
(don2.bagt <- table(don2.test[,3], don2.bagprd))
sum(diag(don2.bagt))/sum(don2.bagt)
install.packages(boost)
install.packages(ada)
install('xgboost')
install.packages("xgboost")
library(xgboost)
library(Matrix)
install.packages("nnet")
install.packages("nnet")
install.packages("nnet")
install.packages("nnet")
library(nnet)
don_nnet <- nnet(type~., data=don.train, size=2, rang=.1,decay=5e-4,maxit=200)
don_nnet <- nnet(type~., data=don1.train, size=2, rang=.1,decay=5e-4,maxit=200)
don1_nnet <- nnet(type~., data=don1.train, size=2, rang=.1,decay=5e-4,maxit=200)
rm(don_nnet)
result_prd_nnet <- predict(don1_nnet,don1_test,type="class")
result_prd_nnet <- predict(don1_nnet,don1.test,type="class")
table(result_prd_nnet, don1.test$type)
View(donguri2)
don2 <- donguri2[,1:2]
View(don2)
don2.hc1 <- hclust(dist(don2), "single")
(don2.cl1 <- cutree(don2.hc1, k=2))
iris2.lab1 <- c(rep(1,43),rep(2,46))
don2.lab1 <- c(rep(1,43),rep(2,46))
table(don2.lab1, don2.cl1)
don2.hc1$marge
plot(don2.hc1, hang=-1, main="single")
don2.hc2 <- hclust(dist(don2), "complete")
(don2.cl2 <- cutree(don2.hc2, k=2))
table(don2.lab1, don2.cl2)
plot(don2.hc2, hang=-1, main="complete")
c(rep(1:89),don2)
don2_2 <- c(rep(1:89),don2)
rm(list=ls())
don2 <- donguri2[,1:2]
don2.hc1 <- hclust(dist(don2), "single")
(don2.cl1 <- cutree(don2.hc1, k=2))
don2.lab1 <- c(rep(1,43),rep(2,46))
table(don2.lab1, don2.cl1)
plot(don2.hc1, hang=-1, main="single")
don2.hc2 <- hclust(dist(don2), "complete")
(don2.cl2 <- cutree(don2.hc2, k=2))
table(don2.lab1, don2.cl2)
donguri2 <- read.csv("donguri2.csv")
don2 <- donguri2[,1:2]
don2.hc1 <- hclust(dist(don2), "single")
(don2.cl1 <- cutree(don2.hc1, k=2))
don2.lab1 <- c(rep(1,43),rep(2,46))
table(don2.lab1, don2.cl1)
plot(don2.hc1, hang=-1, main="single")
don2.hc2 <- hclust(dist(don2), "complete")
(don2.cl2 <- cutree(don2.hc2, k=2))
table(don2.lab1, don2.cl2)
plot(don2.hc2, hang=-1, main="complete")
don2 <- donguri2[,2:3]
don2.hc1 <- hclust(dist(don2), "single")
(don2.cl1 <- cutree(don2.hc1, k=2))
don2.lab1 <- c(rep(1,43),rep(2,46))
table(don2.lab1, don2.cl1)
plot(don2.hc1, hang=-1, main="single")
don2.hc2 <- hclust(dist(don2), "complete")
(don2.cl2 <- cutree(don2.hc2, k=2))
table(don2.lab1, don2.cl2)
plot(don2.hc2, hang=-1, main="complete")
View(don2)
don2.cop1 <- cophenetic(don2.hc1)
cor(don2.cop1, dist(don2))
don2.lab <- c(rep(1,43),rep(2,46))
don2.ta <- table(don2.lab, don2.cl1)
sum(diag(don2.ta1))/100
don2.ta1 <- table(don2.lab, don2.cl1)
sum(diag(don2.ta1))/100
png("cluster.png")
plot(don2.hc1, hang=-1, main="single")
dev.off()
png("clusterSingle.png")
plot(don2.hc1, hang=-1, main="single")
dev.off()
plot(don2.hc1, hang=-1, main="single")
don2.cop1 <- cophenetic(don2.hc1)
cor(don2.cop1, dist(don2))
don2.ta1 <- table(don2.lab, don2.cl1)
sum(diag(don2.ta1))/100
don2.hc2 <- hclust(dist(don2), "complete")
(don2.cl2 <- cutree(don2.hc2, k=2))
table(don2.lab, don2.cl2)
png("clusterComplete.png")
plot(don2.hc2, hang=-1, main="complete")
dev.off()
plot(don2.hc2, hang=-1, main="complete")
don2.cop2 <- cophenetic(don2.hc2)
cor(don2.cop2, dist(don2))
don2.ta2 <- table(don2.lab, don2.cl2)
sum(diag(don2.ta2))/100
par(mfrow=c(2,2))
plot(don2.hc2, hang=-1, main="complete")
don2.hc3 <- hclust(dist(don2), "average")
(don2.cl3 <- cutree(don2.hc3, k=2))
table(don2.lab, don2.cl3)
plot(don2.hc3, hang=-1, main="average")
don2.cop3 <- cophenetic(don2.hc3)
cor(don2.cop3, dist(don2))  #コーフェン相関係数：0.70
don2.ta3 <- table(don2.lab, don2.cl3)
sum(diag(don2.ta3))/100     #正解率70%
plot(don2.hc2, hang=-1, main="complete")
plot(don2.hc1, hang=-1, main="single")
plot(don2.hc1, hang=-1, main="single")
par(mfrow=c(1,1))
plot(don2.hc3, hang=-1, main="average")
png("clusterAverage.png")
plot(don2.hc3, hang=-1, main="average")
dev.off()
don2.cop3 <- cophenetic(don2.hc3)
cor(don2.cop3, dist(don2))  #コーフェン相関係数：0.70
don2.ta3 <- table(don2.lab, don2.cl3)
sum(diag(don2.ta3))/100     #正解率70%
cor(don2.cop2, dist(don2))   #コーフェン相関係数：0.70
don2.ta2 <- table(don2.lab, don2.cl2)
sum(diag(don2.ta2))/100     #正解率70%
sum(diag(don2.ta2))/100     #正解率70%
cor(don2.cop3, dist(don2))   #コーフェン相関係数：0.84
don2.ta3 <- table(don2.lab, don2.cl3)
sum(diag(don2.ta3))/100     #正解率84%
don2.hc4 <- hclust(dist(don2), "centroid")
(don2.cl4 <- cutree(don2.hc4, k=2))
table(don2.lab, don2.cl4)
png("clusterCentroid.png")
plot(don2.hc4, hang=-1, main="centroid")
dev.off()
don2.cop4 <- cophenetic(don2.hc4)
cor(don2.cop4, dist(don2))   #コーフェン相関係数：0.84
don2.ta4 <- table(don2.lab, don2.cl4)
sum(diag(don2.ta4))/100     #正解率84%
plot(don2.hc4, hang=-1, main="centroid")
don2.hc5 <- hclust(dist(don2), "median")
(don2.cl5 <- cutree(don2.hc5, k=2))
table(don2.lab, don2.cl5)
png("clusterMedian.png")
plot(don2.hc5, hang=-1, main="median")
dev.off()
plot(don2.hc5, hang=-1, main="median")
don2.cop5 <- cophenetic(don2.hc5)
cor(don2.cop5, dist(don2))   #コーフェン相関係数：0.84
don2.ta5 <- table(don2.lab, don2.cl5)
sum(diag(don2.ta5))/100     #正解率84%
don2.hc6 <- hclust(dist(don2), "ward.2D")
don2.hc6 <- hclust(dist(don2), "ward")
don2.hc6 <- hclust(dist(don2), "ward.D2")
(don2.cl6 <- cutree(don2.hc6, k=2))
table(don2.lab, don2.cl6)
plot(don2.hc3, hang=-1, main="ward.D2")
plot(don2.hc3, hang=-1, main="ward.D2")
dev.off()
png("clusterWard.png")
plot(don2.hc3, hang=-1, main="ward.D2")
dev.off()
don2.cop6 <- cophenetic(don2.hc6)
cor(don2.cop6, dist(don2))   #コーフェン相関係数：0.84
don2.ta6 <- table(don2.lab, don2.cl6)
sum(diag(don2.ta6))/100     #正解率84%
don2.hc7 <- hclust(dist(don2), "McQuitty")
(don2.cl7 <- cutree(don2.hc7, k=2))
don2.hc7 <- hclust(dist(don2), "mcquitty")
(don2.cl7 <- cutree(don2.hc7, k=2))
table(don2.lab, don2.cl7)
plot(don2.hc7, hang=-1, main="McQuitty")
png("clusterMcQuitty.png")
plot(don2.hc7, hang=-1, main="McQuitty")
dev.off()
don2.cop7 <- cophenetic(don2.hc7)
cor(don2.cop7, dist(don2))   #コーフェン相関係数：0.84
don2.ta7 <- table(don2.lab, don2.cl7)
sum(diag(don2.ta7))/100     #正解率84%
View(don2)
don2.km <- kmeans(don2, 2)
table(don2.lab, don2.km$cluster)/50
table(don2.lab, don2.km$cluster)
table(don2.lab, don2.km$cluster)/50
don2.ta <- table(don2.lab, don2.km$cluster)/50
sum(diag(don2.ta))/100
don2.ta7 <- table(don2.lab, don2.cl7)
sum(diag(don2.ta7))/100     #正解率88%
don2.ta <- table(don2.lab, don2.km$cluster)/50
don2.km <- kmeans(don2, 2)
table(don2.lab, don2.km$cluster)/50
don2.km <- kmeans(don2, 2)
table(don2.lab, don2.km$cluster)/50
library("rpart", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
install.packages("survival")
install.packages("rpart.plot")
install.packages("partykit")
library(rpart)
library(rpart.plot)
library(partykit)
View(don2)
View(donguri2)
ct <- rpart(type~., data = donguri2, method = "class")
print(ct)
par(xpd = NA)
plot(ct, branch = 0.8, margin = 0.05)
text(ct, use.n = TRUE, all = TRUE)
rpart.plot(ct, type=1, uniform = TRUE, extra = 1, under=1, faclen=0)
plot(as.party(ct))
printcp(ct)
plotcp(ct)
donguri2 <- read.csv("donguri3.csv")
don2 <- donguri2[,2:3]
don2.hc1 <- hclust(dist(don2), "single")
(don2.cl1 <- cutree(don2.hc1, k=2))
don2.lab <- c(rep(1,43),rep(2,46))
table(don2.lab1, don2.cl1)
png("clusterSingle.png")
plot(don2.hc1, hang=-1, main="single")
dev.off()
don2.cop1 <- cophenetic(don2.hc1)
cor(don2.cop1, dist(don2))  #コーフェン相関係数：0.39
don2.ta1 <- table(don2.lab, don2.cl1)
plot(don2.hc1, hang=-1, main="single")
don2.lab <- c(rep(1,43),rep(2,46),rep(3,42))
table(don2.lab1, don2.cl1)
plot(don2.hc1, hang=-1, main="single")
don2.cop1 <- cophenetic(don2.hc1)
cor(don2.cop1, dist(don2))  #コーフェン相関係数：0.39
don2.ta1 <- table(don2.lab, don2.cl1)
sum(diag(don2.ta1))/100     #正解率42%
png("clusterSingle.png")
plot(don2.hc1, hang=-1, main="single")
dev.off()
don2.hc2 <- hclust(dist(don2), "complete")
(don2.cl2 <- cutree(don2.hc2, k=2))
table(don2.lab, don2.cl2)
png("clusterComplete.png")
plot(don2.hc2, hang=-1, main="complete")
dev.off()
don2.cop2 <- cophenetic(don2.hc2)
cor(don2.cop2, dist(don2))   #コーフェン相関係数：0.70
don2.ta2 <- table(don2.lab, don2.cl2)
sum(diag(don2.ta2))/100     #正解率80%
don2.hc3 <- hclust(dist(don2), "average")
(don2.cl3 <- cutree(don2.hc3, k=2))
table(don2.lab, don2.cl3)
png("clusterAverage.png")
plot(don2.hc3, hang=-1, main="average")
donguri2 <- read.csv("donguri3.csv")
don2 <- donguri2[,2:3]
don2.hc1 <- hclust(dist(don2), "single")
(don2.cl1 <- cutree(don2.hc1, k=3))
don2.lab <- c(rep(1,43),rep(2,46),rep(3,42))
table(don2.lab1, don2.cl1)
plot(don2.hc1, hang=-1, main="single")
table(don2.lab1, don2.cl1)
View(don2)
table(don2.lab, don2.cl1)
plot(don2.hc1, hang=-1, main="single")
png("clusterSingle.png")
plot(don2.hc1, hang=-1, main="single")
dev.off()
don2.cop1 <- cophenetic(don2.hc1)
cor(don2.cop1, dist(don2))  #コーフェン相関係数：0.39
don2.ta1 <- table(don2.lab, don2.cl1)
sum(diag(don2.ta1))/100     #正解率42%
don2.hc2 <- hclust(dist(don2), "complete")
(don2.cl2 <- cutree(don2.hc2, k=3))
table(don2.lab, don2.cl2)
plot(don2.hc2, hang=-1, main="complete")
png("clusterComplete.png")
plot(don2.hc2, hang=-1, main="complete")
dev.off()
don2.cop2 <- cophenetic(don2.hc2)
cor(don2.cop2, dist(don2))   #コーフェン相関係数：0.70
don2.ta2 <- table(don2.lab, don2.cl2)
sum(diag(don2.ta2))/100     #正解率80%
don2.hc3 <- hclust(dist(don2), "average")
(don2.cl3 <- cutree(don2.hc3, k=3))
table(don2.lab, don2.cl3)
plot(don2.hc3, hang=-1, main="average")
png("clusterAverage.png")
plot(don2.hc3, hang=-1, main="average")
dev.off()
don2.cop3 <- cophenetic(don2.hc3)
cor(don2.cop3, dist(don2))   #コーフェン相関係数：0.84
don2.ta3 <- table(don2.lab, don2.cl3)
sum(diag(don2.ta3))/100     #正解率84%
don2.hc4 <- hclust(dist(don2), "centroid")
(don2.cl4 <- cutree(don2.hc4, k=3))
table(don2.lab, don2.cl4)
png("clusterCentroid.png")
plot(don2.hc4, hang=-1, main="centroid")
dev.off()
plot(don2.hc4, hang=-1, main="centroid")
don2.cop4 <- cophenetic(don2.hc4)
cor(don2.cop4, dist(don2))   #コーフェン相関係数：0.82
don2.ta4 <- table(don2.lab, don2.cl4)
sum(diag(don2.ta4))/100     #正解率88%
don2.hc5 <- hclust(dist(don2), "median")
(don2.cl5 <- cutree(don2.hc5, k=3))
table(don2.lab, don2.cl5)
plot(don2.hc5, hang=-1, main="median")
png("clusterMedian.png")
plot(don2.hc5, hang=-1, main="median")
dev.off()
don2.cop5 <- cophenetic(don2.hc5)
cor(don2.cop5, dist(don2))   #コーフェン相関係数：0.71
don2.ta5 <- table(don2.lab, don2.cl5)
sum(diag(don2.ta5))/100     #正解率44%
don2.hc6 <- hclust(dist(don2), "ward.D2")
(don2.cl6 <- cutree(don2.hc6, k=3))
table(don2.lab, don2.cl6)
plot(don2.hc3, hang=-1, main="ward.D2")
png("clusterWard.png")
plot(don2.hc3, hang=-1, main="ward.D2")
dev.off()
don2.cop6 <- cophenetic(don2.hc6)
cor(don2.cop6, dist(don2))   #コーフェン相関係数：0.82
don2.ta6 <- table(don2.lab, don2.cl6)
sum(diag(don2.ta6))/100     #正解率86%
don2.hc7 <- hclust(dist(don2), "mcquitty")
(don2.cl7 <- cutree(don2.hc7, k=3))
table(don2.lab, don2.cl7)
plot(don2.hc7, hang=-1, main="McQuitty")
png("clusterMcQuitty.png")
plot(don2.hc7, hang=-1, main="McQuitty")
dev.off()
don2.cop7 <- cophenetic(don2.hc7)
cor(don2.cop7, dist(don2))   #コーフェン相関係数：0.81
don2.ta7 <- table(don2.lab, don2.cl7)
sum(diag(don2.ta7))/100     #正解率88%
don2.km <- kmeans(don2, 2)
don2.km <- kmeans(don2, 3)
table(don2.lab, don2.km$cluster)/50
don2.km <- kmeans(don2, 3)
table(don2.lab, don2.km$cluster)/50
don2.km <- kmeans(don2, 3)
table(don2.lab, don2.km$cluster)/50
table(don2.lab, don2.km$cluster)/50
don2.km <- kmeans(don2, 3)
table(don2.lab, don2.km$cluster)/50
don2.km <- kmeans(don2, 3)
table(don2.lab, don2.km$cluster)/50
don2.km <- kmeans(don2, 3)
table(don2.lab, don2.km$cluster)/50
ct <- rpart(type~., data = donguri2, method = "class")
print(ct)
par(xpd = NA)
plot(ct, branch = 0.8, margin = 0.05)
text(ct, use.n = TRUE, all = TRUE)
rpart.plot(ct, type=1, uniform = TRUE, extra = 1, under=1, faclen=0)
plot(as.party(ct))
printcp(ct)
plotcp(ct)
