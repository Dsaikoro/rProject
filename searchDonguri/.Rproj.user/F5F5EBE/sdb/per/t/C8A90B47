{
    "collab_server" : "",
    "contents" : "donguri2 <- read.csv(\"donguri2.csv\")\ndonguri3 <- read.csv(\"donguri3.csv\")\ndon2 <- donguri2[,2:3]\ndon3 <- donguri3[,2,3]\n#最近隣法\ndon2.hc1 <- hclust(dist(don2), \"single\")\n(don2.cl1 <- cutree(don2.hc1, k=2))\ndon2.lab <- c(rep(1,43), rep(2,46))\ntable(don2.lab, don2.cl1)\npng(\"clusterSingle2.png\")\nplot(don2.hc1, hang=-1, main=\"single\")\ndev.off()\ndon2.cop1 <- cophenetic(don2.hc1)\ncor(don2.cop1, dist(don2))  #コーフェン相関係数：0.39\n(don2.ta1 <- table(don2.lab, don2.cl1))\nsum(diag(don2.ta1))/89     #正解率47%\n\ndon3.hc1 <- hclust(dist(don3), \"single\")\n(don3.cl1 <- cutree(don3.hc1, k=3))\ndon3.lab <- c(rep(1,43),rep(2,46),rep(3,42))\ntable(don3.lab, don3.cl1)\npng(\"clusterSingle3.png\")\nplot(don3.hc1, hang=-1, main=\"single\")\ndev.off()\ndon3.cop1 <- cophenetic(don3.hc1)\ncor(don3.cop1, dist(don3))  #コーフェン相関係数：0.60\n(don3.ta1 <- table(don3.lab, don3.cl1))\nsum(diag(don3.ta1))/131     #正解率35%\n\n #最遠隣法\ndon2.hc2 <- hclust(dist(don2), \"complete\")\n(don2.cl2 <- cutree(don2.hc2, k=2))\ntable(don2.lab, don2.cl2)\npng(\"clusterComplete2.png\")\nplot(don2.hc2, hang=-1, main=\"complete\")\ndev.off()\ndon2.cop2 <- cophenetic(don2.hc2)\ncor(don2.cop2, dist(don2))   #コーフェン相関係数：0.70\ndon2.ta2 <- table(don2.lab, don2.cl2)\nsum(diag(don2.ta2))/89     #正解率90%\n\ndon3.hc2 <- hclust(dist(don3), \"complete\")\n(don3.cl2 <- cutree(don3.hc2, k=3))\ntable(don3.lab, don3.cl2)\npng(\"clusterComplete3.png\")\nplot(don3.hc2, hang=-1, main=\"complete\")\ndev.off()\ndon3.cop2 <- cophenetic(don3.hc2)\ncor(don3.cop2, dist(don3))   #コーフェン相関係数：0.79\n(don3.ta2 <- table(don3.lab, don3.cl2))\nsum(diag(don3.ta2))/131     #正解率85%\n\n#群平均法\ndon2.hc3 <- hclust(dist(don2), \"average\")\n(don2.cl3 <- cutree(don2.hc3, k=2))\ntable(don2.lab, don2.cl3)\npng(\"clusterAverage2.png\")\nplot(don2.hc3, hang=-1, main=\"average\")\ndev.off()\ndon2.cop3 <- cophenetic(don2.hc3)\ncor(don2.cop3, dist(don2))   #コーフェン相関係数：0.84\n(don2.ta3 <- table(don2.lab, don2.cl3))\nsum(diag(don2.ta3))/89     #正解率94%\n\ndon3.hc3 <- hclust(dist(don3), \"average\")\n(don3.cl3 <- cutree(don3.hc3, k=3))\ntable(don3.lab, don3.cl3)\npng(\"clusterAverage3.png\")\nplot(don3.hc3, hang=-1, main=\"average\")\ndev.off()\ndon3.cop3 <- cophenetic(don3.hc3)\ncor(don3.cop3, dist(don3))   #コーフェン相関係数：0.80\n(don3.ta3 <- table(don3.lab, don3.cl3))\nsum(diag(don3.ta3))/131     #正解率89%\n\n#重心法\ndon2.hc4 <- hclust(dist(don2), \"centroid\")\n(don2.cl4 <- cutree(don2.hc4, k=2))\ntable(don2.lab, don2.cl4)\npng(\"clusterCentroid2.png\")\nplot(don2.hc4, hang=-1, main=\"centroid\")\ndev.off()\ndon2.cop4 <- cophenetic(don2.hc4)\ncor(don2.cop4, dist(don2))   #コーフェン相関係数：0.82\n(don2.ta4 <- table(don2.lab, don2.cl4))\nsum(diag(don2.ta4))/89     #正解率99%\n\ndon3.hc4 <- hclust(dist(don3), \"centroid\")\n(don3.cl4 <- cutree(don3.hc4, k=3))\ntable(don3.lab, don3.cl4)\npng(\"clusterCentroid3.png\")\nplot(don3.hc4, hang=-1, main=\"centroid\")\ndev.off()\ndon3.cop4 <- cophenetic(don3.hc4)\ncor(don3.cop4, dist(don3))   #コーフェン相関係数：0.80\n(don3.ta4 <- table(don3.lab, don3.cl4))\nsum(diag(don3.ta4))/131     #正解率99%\n\n#メディアン法\ndon2.hc5 <- hclust(dist(don2), \"median\")\n(don2.cl5 <- cutree(don2.hc5, k=2))\ntable(don2.lab, don2.cl5)\npng(\"clusterMedian2.png\")\nplot(don2.hc5, hang=-1, main=\"median\")\ndev.off()\ndon2.cop5 <- cophenetic(don2.hc5)\ncor(don2.cop5, dist(don2))   #コーフェン相関係数：0.72\ndon2.ta5 <- table(don2.lab, don2.cl5)\nsum(diag(don2.ta5))/89     #正解率49%\n\ndon3.hc5 <- hclust(dist(don3), \"median\")\n(don3.cl5 <- cutree(don3.hc5, k=3))\ntable(don3.lab, don3.cl5)\npng(\"clusterMedian3.png\")\nplot(don3.hc5, hang=-1, main=\"median\")\ndev.off()\ndon3.cop5 <- cophenetic(don3.hc5)\ncor(don3.cop5, dist(don3))   #コーフェン相関係数：0.79\n(don3.ta5 <- table(don3.lab, don3.cl5))\nsum(diag(don3.ta5))/131     #正解率85%\n\n#ウォード法\ndon2.hc6 <- hclust(dist(don2), \"ward.D2\")\n(don2.cl6 <- cutree(don2.hc6, k=2))\ntable(don2.lab, don2.cl6)\npng(\"clusterWard2.png\")\nplot(don2.hc3, hang=-1, main=\"ward.D2\")\ndev.off()\ndon2.cop6 <- cophenetic(don2.hc6)\ncor(don2.cop6, dist(don2))   #コーフェン相関係数：0.82\n(don2.ta6 <- table(don2.lab, don2.cl6))\nsum(diag(don2.ta6))/89     #正解率97%\n\ndon3.hc6 <- hclust(dist(don3), \"ward.D2\")\n(don3.cl6 <- cutree(don3.hc6, k=3))\ntable(don3.lab, don3.cl6)\npng(\"clusterWard3.png\")\nplot(don3.hc6, hang=-1, main=\"ward.D2\")\ndev.off()\ndon3.cop6 <- cophenetic(don3.hc6)\ncor(don3.cop6, dist(don3))   #コーフェン相関係数：0.71\n(don3.ta6 <- table(don3.lab, don3.cl6))\nsum(diag(don3.ta6))/131     #正解率77%\n\n#McQuitty\ndon2.hc7 <- hclust(dist(don2), \"mcquitty\")\n(don2.cl7 <- cutree(don2.hc7, k=2))\ntable(don2.lab, don2.cl7)\npng(\"clusterMcQuitty2.png\")\nplot(don2.hc7, hang=-1, main=\"McQuitty\")\ndev.off()\ndon2.cop7 <- cophenetic(don2.hc7)\ncor(don2.cop7, dist(don2))   #コーフェン相関係数：0.81\n(don2.ta7 <- table(don2.lab, don2.cl7))\nsum(diag(don2.ta7))/89     #正解率99%\n\ndon3.hc7 <- hclust(dist(don3), \"mcquitty\")\n(don3.cl7 <- cutree(don3.hc7, k=3))\ntable(don3.lab, don3.cl7)\npng(\"clusterMcQuitty3.png\")\nplot(don3.hc7, hang=-1, main=\"McQuitty\")\ndev.off()\ndon3.cop7 <- cophenetic(don3.hc7)\ncor(don3.cop7, dist(don3))   #コーフェン相関係数：0.70\n(don3.ta7 <- table(don3.lab, don3.cl7))\nsum(diag(don3.ta7))/131     #正解率61%\n",
    "created" : 1491534352130.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2472225866",
    "id" : "C8A90B47",
    "lastKnownWriteTime" : 1491808771,
    "last_content_update" : 1491808771962,
    "path" : "~/git/rProject/searchDonguri/cluster.R",
    "project_path" : "cluster.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}